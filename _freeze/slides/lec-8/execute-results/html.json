{
  "hash": "964454f18369716dc09045f51de8db09",
  "result": {
    "markdown": "---\ntitle: \"Principles of Inference\"\nsubtitle: \"STA 101L - Summer I 2022\"\nauthor: \"Raphael Morsomme\"\nfooter:  \"[https://rmorsomme.github.io/website/](https://rmorsomme.github.io/website/)\"\nlogo: \"images/logo.jpg\"\nformat: \n  revealjs: \n    theme: slides.scss\n    multiplex: true\n    transition: fade\n    slide-number: true\n    code-fold: false\n    code-summary: \"Show the code\"\n    scrollable: true\neditor: visual\nexecute:\n  freeze: auto\n  echo: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n# Welcome\n\n## Announcements\n\n-   \n\n## Recap\n\n## Outline\n\n-   Statistical inference\n-   Confidence intervals\n-   Hypothesis tests\n    -   Types of errors\n-   Five cases\n    -   single proportion\n    -   difference between two portions\n    -   single mean\n    -   difference between two means\n    -   regression parameters\n-   Hypothesis test\n-   Modern statistics\n\n# Statistical inference\n\n## Statistical inference\n\nWe are want to learn about the (unknown) **parameter** of some **population** of interest.\n\nWe dispose of a **sample**\n\n-   In the remainder of the course, we will always assume that we have a *random* sample\n\n. . .\n\n**Inference**: estimate the **population parameter** from the **sample**.\n\n**Inference**: estimate the **population parameter** from the **sample** and rigorously quantify our certainty in the estimate.\n\n\n## \n::: {.callout-tip icon=\"false\"}\n## Group exercise - identify the parameter\nExercise [11.1](https://openintro-ims.netlify.app/foundations-randomization.html#chp11-exercises)\n:::\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_628f9822\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n## Estimating a proportion\n\n**parameter of interest**: proportion in the population\n\n**sample statistic**: sample proportion\n\nIt seems natural to use the sample proportion as an estimate for the population proportion.\n\n## Our certainty in the estimate matters\n\nA single point does not indicate how confident we are in our estimation.\n\n-   If we have a *large* sample, then we can be pretty confident that our estimate will likely be close to the true value fo the parameter,\n\n-   if we have a *small* sample, then we know that our estimate may be far from the truth.\n\n-   e.g. basketball free throws, ratings on Yelp or Amazon\n\n## Statistical inference\n\nFramework to make rigorous statements about uncertainty in our estimates\n\n-   confidence intervals\n    \n    -   range of plausible values for the population parameter\n\n    -   \"we are 90% confident that the interval $(20\\%, 30\\%)$ captures the true value of the population proportion\".\n\n-   hypothesis tests\n\n    -   evaluate competing claims using data\n\n    -   \"we reject the claim that the population proportion is $50\\%$\".\n\n# Five cases\n\n## Case 1 -- Single proportion {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\nWhat is the proportion of vegetarian among Duke students?\n\n. . .\n\n**Population parameter**: proportion of vegetarian among Duke students ($p$)\n\n**sample statistics**: proportion of vegetarian in the sample $\\hat{p}$\n:::\n\n::: {.column width=\"50%\"}\n![](images/lec-8/vegetarian.jpg)\n:::\n:::\n\n. . .\n\n**Confidence interval**: $(0.31, 0.43)$\n\n-   we are 95% confident that the interval $(0.31, 0.43)$ capture the proportion of vegetarian among Duke students.\n\n. . .\n\n**Hypothesis test**: is the proportion of vegetarian among Duke students $0.5$?\n\n-   $H_0:p=0.5, H_a:p\\neq0.5$\n\n-   The data collected provide strong evidence against $H_0$, that is, against the hypothesis that half of Duke students are vegetarian. In other words, the data conflict so much with $H_0$, that the null hypothesis is not plausible.\n\n## Case 2 -- Difference between two proportions {.smaller}\n\nIs the proportion of vegetarian the same among undergraduate Duke student and graduate Duke students?\n\n**Population parameter**: difference between the proportion of vegetarian among undergraduate Duke students and graduate Duke students ($p_{diff} = p_{undergrad}-p_{grad}$)\n\n**sample statistics**: different in proportion of vegetarian in the sample $\\hat{p}_{diff} = \\hat{p}_{undergrad} - \\hat{p}_{grad}$\n\n. . .\n\n**Confidence interval**: $(-0.05, 0.08)$\n\n-   we are 95% confident that the interval $(-0.05, 0.08)$ capture the true value of $p_{diff}$.\n\n. . .\n\n**Hypothesis test**: is the proportion of vegetarian the same among undergraduate and graduate Duke students?\n\n-   $H_0:p_{diff}=0, H_a:p_{diff}\\neq0$ (no difference)\n\n-   The data collected do not provide strong evidence against $H_0$, that is, against the hypothesis that $p_{diff}=0$.\n\n## Case 3 -- Single mean\n\n::: columns\n::: {.column width=\"50%\"}\nHow much time do Duke students sleep on average per night?\n\n. . .\n\n**Population parameter**: mean amount of time that Duke students sleep per night ($\\mu$)\n\n**sample statistics**: average amount of time that Duke students in the sample sleep per night ($\\bar{x}$)\n:::\n\n::: {.column width=\"50%\"}\n![](images/lec-8/sleep.jpg)\n:::\n:::\n\n. . .\n\n**Confidence interval**: $(5.5, 7.5)$\n\n-   we are 95% confident that the interval $(5.5, 7.5)$ capture $\\mu$.\n\n. . .\n\n**Hypothesis test**: is the proportion of vegetarian among Duke students $0.5$?\n\n-   $H_0:\\mu=8, H_a:\\mu\\neq8$\n\n-   The data collected provide strong evidence against $H_0$, that is, against the hypothesis that Duke students sleep on average 8 hours per night.\n\n## Case 4 -- Difference between two proportions\n\nDo undergraduate Duke students sleep the same mount of time per night as graduate Duke students do?\n\n. . .\n\n**Population parameter**: difference between the mean amount of time that Duke undergraduate and graduate students sleep per night ($\\mu_{diff} = \\mu_{undergrad}-\\mu_{grad}$)\n\n**sample statistics**: difference between the mean amount of time that Duke undergraduate and graduate students in the sample sleep per night ($\\bar{x}_{diff} = \\bar{x}_{undergrad} - \\bar{x}_{grad}$)\n\n. . .\n\n**Confidence interval**: $(-0.5, 1)$\n\n-   we are 95% confident that the interval $(-0.5, 1)$ capture $\\mu_{diff}$.\n\n. . .\n\n**Hypothesis test**: is the proportion of vegetarian among Duke students $0.5$?\n\n-   $H_0:\\mu_{diff}=0, H_a:\\mu_{diff}\\neq0$\n\n-   The data collected do not provide strong evidence against $H_0$, that is, against the hypothesis that undergraduate and graduate Duke students sleep on average the amount of time per night.\n\n# Hypothesis tests\n\n## The null hypothesis and the alternative hypothesis\nConsider the 2nd case (difference in proportion of vegetarians between undergrad and grad students).\n\n-   If $H_0$ is true (the two populations have the same proportion)\n    -   we'll probably still observe a small difference in the sample\n\n-   If $H_a$ is true,\n    -   we'll probably observed a larger difference in the sample,\n    -   but we might also observe no difference at all,\n    -   or observe a different in the wrong direction!\n\n. . .\n\n\n## \n::: {.callout-tip icon=\"false\"}\n## Group exercise - hypotheses\nExercises [11.3](https://openintro-ims.netlify.app/foundations-randomization.html#chp11-exercises), [11.5](https://openintro-ims.netlify.app/foundations-randomization.html#chp11-exercises)\n:::\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_628f9524\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n\n## Natural variability\n\n::: callout-warning\n## Natural variability and hypothesis tests\n\nObserving a difference in the sample is not sufficient to reject $H_0$. There will always be some natural variability inherent to the data.\n\nDetermining whether the observed difference is due to natural variation or provides convincing evidence of a true difference between the two groups is at the heart of hypothesis tests. \n:::\n\n## \n::: {.callout-tip icon=\"false\"}\n## Group exercise - convincing evidence\nSuppose we have sample of size with the same number of undergrad and grad students and $\\hat{p}_{diff} = \\hat{p}_{undergrad} - \\hat{p}_{grad} = 0.6 - 0.4 = 0.2$. For what sample sizes $n$ do you *intuitively feel* that the observed difference provides **convincing evidence** that the two populations are different?\n\n-   $n=10$ (5 undergrad and 5 grad students)\n-   $n=20$\n-   $n=50$\n-   $n=100$\n-   $n=250$\n-   $n=500$\n-   $n=1000$\n:::\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_628f950e\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">04</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n# Confidence interval\n\n## Confidence interval\n\n**CI**: range of plausible values for the population parameter.\n\nThere always is natural variability in the data\n\n-   If we draw a second sample from the population, the proportion in the two sample will probably differ\n\n-   there is thus no reason to believe that the proportion in the first sanoke is exactly equal to the population proportion\n\n\n\n\n# Modern statistics\n\n## Classical and modern approaches\n\nThere will be two approaches for each of the CI and HT for each of the five cases ($2*2*5=20$ methods)\n\nLuckily, they are all very similar, and most require at most 3 lines of code in `R` (and most s single line!).\n\n. . . \n\n**Classical approaches** are based on (simple) mathematical formula -- pen and paper.\n\n**Modern approaches** rely on (simple) computer simulations -- `R`\n\n# A first glimpse of modern statistics for HT\n\n## \n::: {.callout-tip icon=\"false\"}\n## Group exercise - simulation\nSuppose you flip a coin 100 times and count the number of heads.\nEarlier in the class, you were asked to identify what number of heads would make you doubt that the coin is fair.\n\nWe will run an experiment together to see if you gut feeling was feel was correct.\n\nUse the following commands to simulate 100 flips of a coin and count the number of heads. Repeat the experiment 20 times, keeping track of the number of heads.\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(0)\nflips <- rbernoulli(100, p = 0.5) # 100 flips -- TRUE is heads and FALSE is tails\nsum(flips) # number of heads (number of TRUEs)\n```\n\n::: {.cell-output-stdout}\n```\n[1] 48\n```\n:::\n:::\n\n\n## For-loop\n\nThe following for-loop does the previous experiment more efficiently!\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(0)\nresults <- tibble(n_heads = numeric())\nfor(i in 1 : 3e3){ # repeat the experiment 3,000 times\n  flips   <- rbernoulli(100, p = 0.5)\n  n_heads <- sum(flips)\n  results <- results %>% add_row(n_heads)\n}\nresults %>%\n  ggplot() +\n  geom_histogram(aes(n_heads), binwidth = 1) # set the binwidth to 1 to ensure that each bin corresponds to exactly one integer.\n```\n\n::: {.cell-output-display}\n![](lec-8_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n## Hypothesis test\n\n::: callout-tip\n## Population and parameter first\nAlways start with defining the population and the parameter of interest.\n\n**Population**: flips of the coin\n\n**Parameter**: probability that a flip is head\n:::\n\n. . .\n\n-   $H_0:p=0.5$ (the coin is fair)\n\n-   $H_0:p\\neq0.5$ (the coin is not fair)\n\n\n## Like a court in the justice system\n\n-   $H_0:$ innocent (the coin is fair)\n\n-   $H_0:$ guilty (the coin is not fair)\n\nQuestion: do the facts (data sample) provide sufficient evidence to reject the claim that the defendant is innocent (that the coin is fair)?\n\n-   If so, we **reject $H_0$**\n\n-   Otherwise, we **fail to reject $H_0$**.\n\n::: callout-note\n## Never accept the null hypothesis\nWe **never** accept the null hypothesis! We only *reject* of *fail to reject* it.\n:::\n\n## Two outcomes {.smaller}\n\nSuppose you observe the following sample: out of 100 flips, you get **55 heads**\n\n$\\Rightarrow$ the sample is plausible under $H_0$; the observed data do not provide strong evidence against the null hypothesis; we fail to reject the claim that the coin is fair\n\n-   The coin might be unfair, but the data do not provide strong evidence against fairness.\n\n. . .\n\nNow suppose that out of 100 flips, you observe **65 heads**.\n\n$\\Rightarrow$ this result is unlikely under $H_0$; the observed data provide strong evidence against the null hypothesis; we reject the claim that the coin is fair\n\n-   The coin might be fair, but $65$ is extreme enough to make reject the claim that the coin is fair.\n\n\n# A first glimpse of modern statistics for HT\n\n",
    "supporting": [
      "lec-8_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"..\\site_libs/countdown-0.3.5/countdown.css\" rel=\"stylesheet\" />\r\n<script src=\"..\\site_libs/countdown-0.3.5/countdown.js\"></script>\r\n"
      ],
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}