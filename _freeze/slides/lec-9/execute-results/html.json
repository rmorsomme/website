{
  "hash": "cf725ff78c7a578940c0dfbdb2923a73",
  "result": {
    "markdown": "---\ntitle: \"Inference for proportions\"\nsubtitle: \"STA 101L - Summer I 2022\"\nauthor: \"Raphael Morsomme\"\nfooter:  \"[https://rmorsomme.github.io/website/](https://rmorsomme.github.io/website/)\"\nlogo: \"images/logo.jpg\"\nformat: \n  revealjs: \n    theme: slides.scss\n    transition: fade\n    slide-number: true\n    code-fold: false\n    code-summary: \"Show the code\"\n    scrollable: true\n    link-external-newwindow: true\n    history: false\neditor: visual\nexecute:\n  freeze: auto\n  echo: true\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n# Welcome\n\n## Announcements\n\n-   Data analysis in action -- [Inferring ethnicity from X-rays](https://www.boston.com/news/health/2022/05/18/scientists-create-ai-race-from-x-rays-dont-know-how-it-works-harvard-mit/)\n-   Anonymous mid-course feedback\n\n## Recap\n\n-   Statistical inference\n\n-   Five cases\n\n-   Hypothesis test\n\n-   Confidence interval\n\n-   A first glimpse of modern statistics\n\n## Outline\n\n-   One proportion (case 1)\n-   Two proportions (case 2)\n\n# One proportion\n\n## Setup\n\n**population parameter**: proportion $p$\n\n**Sample statistics**: sample proportion $\\hat{p}$\n\n. . .\n\n**Hypothesis testing**:\n\n-   $H_0:p=p_0$ where $p_0$ is a number between $0$ and $1$\n\n-   $H_a:p\\neq p_0$\n\n**Confidence interval**: range of plausible values for $p$.\n\n## \n\n::: callout-note\n## One-sided and two-sided $H_a$\n\nOne-sided) $H_a:p>p_0$ or $H_a:p<p_0$\n\nTwo-sided) $H_a: p\\neq p_0$\n\nIt is never wrong to use a two-sided $H_a$.\n:::\n\n## \n\n::: {.callout-tip icon=\"false\"}\n## Individual exercise - Hypotheses\n\nExercise [16.1](https://openintro-ims.netlify.app/inference-one-prop.html#chp16-exercises)\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_62a39ab2\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n## Example -- legalizing marijuana\n\nWhat proportion of US adults support legalizing marijuana?\n\n. . .\n\nSample: 900/1500 support it.\n\n. . .\n\n$$\n\\hat{p} = \\dfrac{900}{1500}=0.6\n$$\n\n# Hypothesis test via simulation\n\n## \n\n$H_0:p=0.5$\n\n$H_a:p\\neq 0.5$\n\n. . .\n\n-   Simulate many samples under $H_0$.\n\n-   Determine if the observed data could have plausibly arisen under $H_0$.\n\n::: callout-note\n## Parametric bootstrap\n\nThe textbook uses the term (parametric) bootstrap to refer to this procedure.\n:::\n\n## \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"|4|5|6|\"}\nset.seed(0)\nresults <-  tibble(p_hat = numeric())\nfor(i in 1 : 1e4){\n  sim     <- rbernoulli(n = 1500, p = 0.5) # simulate a sample under H0\n  p_hat   <- mean(sim)                     # compute the sample statistic p_hat\n  results <- results %>% add_row(p_hat = p_hat)\n}\nggplot(results) + geom_histogram(aes(p_hat))\n```\n\n::: {.cell-output-display}\n![](lec-9_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=80%}\n:::\n:::\n\n## Conclusion\n\n$\\hat{p}=0.6$ is extremely unlikely to happen under $H_0:p=0.5$.\n\nWe therefore **reject the null hypothesis** that half of the people support legalizing marijuana.\n\n## \n\n::: {.callout-tip icon=\"false\"}\n## Group exercise - HT for one proportion\n\nExercise [16.3](https://openintro-ims.netlify.app/inference-one-prop.html#chp16-exercises) -- in part d, you do not need to estimate the p-value.\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_62a39bb0\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n## p-value\n\nWhat if we do not have a clear-cut case?\n\n-   e.g., $\\hat{p}=0.52 = \\dfrac{780}{1500}$\n\n. . .\n\n**p-value**: probability that the sample statistic of a sample simulated under $H_0$ is at least as extreme as that of the observed sample.\n\n-   the probability that $\\hat{p}_{sim} > 0.52$ or $\\hat{p}_{sim} < 0.48$.\n\n## p-value in `R`\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nresults <- results %>%\n  mutate(is_more_extreme = p_hat <= 0.48 | p_hat >= 0.52)\nresults\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 10,000 x 2\n   p_hat is_more_extreme\n   <dbl> <lgl>          \n 1 0.475 TRUE           \n 2 0.485 FALSE          \n 3 0.483 FALSE          \n 4 0.528 TRUE           \n 5 0.51  FALSE          \n 6 0.493 FALSE          \n 7 0.503 FALSE          \n 8 0.5   FALSE          \n 9 0.495 FALSE          \n10 0.503 FALSE          \n# ... with 9,990 more rows\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nresults %>% summarize(p_value = mean(is_more_extreme))\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 1 x 1\n  p_value\n    <dbl>\n1   0.127\n```\n:::\n:::\n\n## p-value in practice\n\nIn practice, if a p-value is smaller than 0.05 we reject $H_0$\n\n-   $\\alpha = 0.05$ is called the **significance level**.\n\n-   If $p<0.05$, the observed sample is in the top 5% of the most extreme simulated samples.\n\n-   It is highly unlikely that the observed sample could have arisen if $H_0$ were true.\n\n-   the difference $\\hat{p}-p_0$ is **statistically significant**.\n\n## \n\n::: callout-note\n## Why $\\alpha = 0.05$?\n\nTo know why the significance level 0.05 is widely used in practice, check out this short [video](https://www.openintro.org/book/stat/why05/).\n:::\n\n## \n\n::: {.callout-tip icon=\"false\"}\n## Group exercise - HT for one proportion\n\nExercise [16.5](https://openintro-ims.netlify.app/inference-one-prop.html#chp16-exercises).\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_62a39d2b\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">04</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n# Confidence interval via bootstrap\n\n## Bootstrapping\n\nSample with repetition from the observed sample to construct many **bootstrap samples**.\n\nBootstrap samples $\\Rightarrow$ sampling distribution $\\Rightarrow$ CI\n\n## \n\n![](images/lec-9/bootstrap1.png)\n\nSource: [IMS](https://www.openintro.org/book/ims/)\n\n## Bootstrap in `R`\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsample_observed <- tibble(support = c(rep(1, 900), rep(0, 600)))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(0)\nslice_sample(sample_observed, n = 5) # 5 random rows from the data frame\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 5 x 1\n  support\n    <dbl>\n1       0\n2       0\n3       1\n4       1\n5       0\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"|1,5|2|3|\"}\nsample_bootstrap <- function(data){\n  n                <- nrow(data)\n  sample_bootstrap <- slice_sample(data, n = n, replace = TRUE)\n  return(sample_bootstrap)\n}\n```\n:::\n\n## \n\n::: {.cell layout-align=\"center\" hash='lec-9_cache/revealjs/unnamed-chunk-10_151d53ed59931de649142462ed66adbf'}\n\n```{.r .cell-code  code-line-numbers=\"|4|5|6|\"}\nresults <- tibble(p_hat = numeric()) # empty data frame to collect the results\nset.seed(0)\nfor(i in 1 : 1e4){\n  d_boot    <- sample_bootstrap(sample_observed) # bootstrap sample\n  stat_boot <- mean(d_boot$support)              # bootstrap statistic\n  results   <- results %>% add_row(p_hat = stat_boot) \n}\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nquantile(results$p_hat, c(0.05 , 0.95 )) # 90% CI\n```\n\n::: {.cell-output-stdout}\n```\n       5%       95% \n0.5793333 0.6206667 \n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nquantile(results$p_hat, c(0.025, 0.975)) # 95% CI (wider)\n```\n\n::: {.cell-output-stdout}\n```\n     2.5%     97.5% \n0.5753333 0.6253333 \n```\n:::\n:::\n\n## \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(results) + \n  geom_histogram(aes(p_hat)) + \n  geom_vline(xintercept = quantile(results$p_hat, c(0.05 , 0.95 )), col = \"gold1\", size = 2) + # 90% CI \n  geom_vline(xintercept = quantile(results$p_hat, c(0.025, 0.975)), col = \"maroon\", size = 2) # 95% CI\n```\n\n::: {.cell-output-display}\n![](lec-9_files/figure-revealjs/unnamed-chunk-13-1.png){fig-align='center' width=80%}\n:::\n:::\n\n## \n\n::: {.callout-tip icon=\"false\"}\n## Group exercise - Bootstrap CI\n\nExercises [12.1](https://openintro-ims.netlify.app/foundations-bootstrapping.html#chp12-exercises) and [12.7](https://openintro-ims.netlify.app/foundations-bootstrapping.html#chp12-exercises)\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_62a39dac\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">30</span></code>\n</div>\n```\n:::\n:::\n\n# Two proportions\n\n## Setup\n\nA **population** divided in two groups.\n\n**Population parameter**: difference in proportion\n\n$$\np_{diff}=p_1-p_2\n$$\n\n**Sample statistics**: difference in proportion in the sample\n\n$$\n\\hat{p}_{diff}=\\hat{p}_1-\\hat{p}_2\n$$\n\n. . .\n\n$H_0:p_{diff}=0$ (no difference between the two groups)\n\n$H_a:p_{diff}\\neq0$\n\n## Example -- sex discrimination\n\nAre individuals who identify as female discriminated against in promotion decisions?\n\n. . .\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Summary results for the sex discrimination study.</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">decision</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> sex </th>\n   <th style=\"text-align:right;\"> promoted </th>\n   <th style=\"text-align:right;\"> not promoted </th>\n   <th style=\"text-align:right;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 7em; \"> male </td>\n   <td style=\"text-align:right;width: 7em; \"> 21 </td>\n   <td style=\"text-align:right;width: 7em; \"> 3 </td>\n   <td style=\"text-align:right;width: 7em; \"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 7em; \"> female </td>\n   <td style=\"text-align:right;width: 7em; \"> 14 </td>\n   <td style=\"text-align:right;width: 7em; \"> 10 </td>\n   <td style=\"text-align:right;width: 7em; \"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 7em; \"> Total </td>\n   <td style=\"text-align:right;width: 7em; \"> 35 </td>\n   <td style=\"text-align:right;width: 7em; \"> 13 </td>\n   <td style=\"text-align:right;width: 7em; \"> 48 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n## \n\n::: {.callout-tip icon=\"false\"}\n## Group exercise - two proportions\n\nWhat are $\\hat{p}_f$, $\\hat{p}_m$ and $\\hat{p}_{diff}$? Do you *intuitively feel* that the data provide convincing evidence of sex discrimination?\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_62a39a31\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">02</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n# Hypothesis test via simulation\n\n## \n\n$H_0:p_{diff}=0$\n\n$H_a:p_{diff}\\neq 0$\n\n. . .\n\n-   Simulate many samples under $H_0$ (no discrimination)\n\n-   Determine if the observed data could have plausibly arisen under $H_0$\n\n## Simulating under $H_0$\n\nUnder $H_0$, there is no discrimination\n\n$\\Rightarrow$ whether someone receives a promotion is independent of their sexual identification,\n\n$\\Rightarrow$ randomly re-assign the $35$ promotions independently of the sexual identification.\n\n## \n\n![](images/lec-9/randomization.png) Source: [IMS](https://www.openintro.org/book/ims/)\n\n## Simulation result\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">decision</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n</tr>\n  <tr>\n   <th style=\"text-align:left;\"> sex </th>\n   <th style=\"text-align:right;\"> promoted </th>\n   <th style=\"text-align:right;\"> not promoted </th>\n   <th style=\"text-align:right;\"> Total </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;width: 7em; \"> male </td>\n   <td style=\"text-align:right;width: 7em; \"> 18 </td>\n   <td style=\"text-align:right;width: 7em; \"> 6 </td>\n   <td style=\"text-align:right;width: 7em; \"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 7em; \"> female </td>\n   <td style=\"text-align:right;width: 7em; \"> 17 </td>\n   <td style=\"text-align:right;width: 7em; \"> 7 </td>\n   <td style=\"text-align:right;width: 7em; \"> 24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;width: 7em; \"> Total </td>\n   <td style=\"text-align:right;width: 7em; \"> 35 </td>\n   <td style=\"text-align:right;width: 7em; \"> 13 </td>\n   <td style=\"text-align:right;width: 7em; \"> 48 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\nSource: [IMS](https://www.openintro.org/book/ims/)\n\n## \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"|1|2|3|\"}\nd <- gender_discrimination\nd_sim <- d %>% mutate(decision = sample(decision)) # shuffle the promotions\nd_sim\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 48 x 2\n   gender decision    \n   <fct>  <fct>       \n 1 male   not promoted\n 2 male   not promoted\n 3 male   promoted    \n 4 male   promoted    \n 5 male   promoted    \n 6 male   promoted    \n 7 male   promoted    \n 8 male   not promoted\n 9 male   promoted    \n10 male   not promoted\n# ... with 38 more rows\n```\n:::\n:::\n\n## Function for computing the test statistic\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"|3,4|5|\"}\ncompute_p_diff <- function(data){\n  p_hat <- data %>%\n    group_by(gender) %>%\n    summarize(p_hat = mean(decision == \"promoted\"))\n  p_diff_hat <- p_hat$p_hat[1] - p_hat$p_hat[2]\n  return(p_diff_hat)\n}\ncompute_p_diff(d_sim)\n```\n\n::: {.cell-output-stdout}\n```\n[1] -0.04166667\n```\n:::\n:::\n\n## For-loop for simulating under $H_0$\n\n::: {.cell layout-align=\"center\" hash='lec-9_cache/revealjs/unnamed-chunk-20_31427450636f1ee4f6741f3034b91a8a'}\n\n```{.r .cell-code}\n# Setup\nresults    <- tibble(p_diff_hat = numeric())\nd          <- gender_discrimination\n\n# Simulations\nset.seed(0)\nfor(i in 1 : 1e4){\n  d_sim      <- d %>% mutate(decision = sample(decision)) # simulate under H0\n  p_diff_hat <- compute_p_diff(d_sim) # test statistic\n  results    <- results %>% add_row(p_diff_hat = p_diff_hat)\n}\n```\n:::\n\n## Sampling distribution\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np_diff_obs <- 21 / 24 - 14 / 24\np_diff_obs\n```\n\n::: {.cell-output-stdout}\n```\n[1] 0.2916667\n```\n:::\n\n```{.r .cell-code}\nggplot(results) + \n  geom_histogram(aes(p_diff_hat)) +\n  geom_vline(xintercept = p_diff_obs, col = \"maroon\", size = 2)\n```\n\n::: {.cell-output-display}\n![](lec-9_files/figure-revealjs/unnamed-chunk-21-1.png){fig-align='center' width=80%}\n:::\n:::\n\n## p-value\n\n**p-value**: probability that the sample statistic of a sample simulated under $H_0$ is at least as extreme as that of the observed sample.\n\n-   the probability that $\\hat{p}_{diff}^{sim}\\ge$ 0.29 or $\\hat{p}_{diff}^{sim}\\le$ -0.29.\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nresults %>%\n  mutate(is_more_extreme = p_diff_hat >= p_diff_obs | p_diff_hat <= -p_diff_obs) %>%\n  summarize(p_value = mean(is_more_extreme))\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 1 x 1\n  p_value\n    <dbl>\n1  0.0435\n```\n:::\n:::\n\n## significance level $\\alpha = 0.05$\n\nUsing the usual significance level $\\alpha = 0.05$, we **reject** the null hypothesis\n\n-   the observed difference in promotions is unlikely to be due to random luck\n-   the difference is **statistically significant**.\n\n## \n\n::: callout-note\n## Statisticians as messengers\n\nStatisticians are just messengers; they only interpret what the data are indicating.\n\nIf you are a scientist and are not happy with the result of a statistical analysis, change the study not the statistician!\n\n-   larger sample\n-   smaller measurement errors\n-   new variables, e.g. salary instead of promotion\n:::\n\n## \n\n::: {.callout-tip icon=\"false\"}\n## Group exercise - HT\n\n[17.1](https://openintro-ims.netlify.app/inference-two-props.html#chp17-exercises) (skip part b)\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_62a39c66\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n# Confidence interval via bootstrap\n\n## \n\nSame idea as before: sample with repetition from the observed data to construct many **bootstrap samples**.\n\nBootstrap samples $\\Rightarrow$ sampling distribution $\\Rightarrow$ CI\n\n## Bootstrap\n\n![](images/lec-9/bootstrap2.png)\n\nSource: [IMS](https://www.openintro.org/book/ims/)\n\n## Bootstrap in `R`\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nd <- gender_discrimination %>%\n  mutate(decision = if_else(decision == \"promoted\", 1, 0))\nsample_observed_m <- d %>% filter(gender == \"male\"  )\nsample_observed_f <- d %>% filter(gender == \"female\")\n\nset.seed(0)\nsample_bootstrap(sample_observed_m) # bootstrap sample\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 24 x 2\n   gender decision\n   <fct>     <dbl>\n 1 male          1\n 2 male          1\n 3 male          1\n 4 male          1\n 5 male          1\n 6 male          0\n 7 male          1\n 8 male          1\n 9 male          1\n10 male          1\n# ... with 14 more rows\n```\n:::\n\n```{.r .cell-code}\nsample_bootstrap(sample_observed_f) # bootstrap sample\n```\n\n::: {.cell-output-stdout}\n```\n# A tibble: 24 x 2\n   gender decision\n   <fct>     <dbl>\n 1 female        1\n 2 female        1\n 3 female        1\n 4 female        1\n 5 female        1\n 6 female        0\n 7 female        1\n 8 female        0\n 9 female        1\n10 female        1\n# ... with 14 more rows\n```\n:::\n:::\n\n## \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"|3,4|5|\"}\nresults <- tibble(p_diff_hat = numeric())\nfor(i in 1 : 1e3){\n  d_boot_m   <- sample_bootstrap(sample_observed_m) # bootstrap sample\n  d_boot_f   <- sample_bootstrap(sample_observed_f) # bootstrap sample\n  p_diff_hat <- compute_p_diff(rbind(d_boot_m, d_boot_f)) # bootstrap statistic\n  results    <- results %>% add_row(p_diff_hat = p_diff_hat)\n}\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nquantile(results$p_diff_hat, c(0.05 , 0.95 )) # 90% CI\n```\n\n::: {.cell-output-stdout}\n```\n 5% 95% \n  0   0 \n```\n:::\n\n```{.r .cell-code}\nquantile(results$p_diff_hat, c(0.05 , 0.95 )) %>% signif(2) # 90% CI\n```\n\n::: {.cell-output-stdout}\n```\n 5% 95% \n  0   0 \n```\n:::\n\n```{.r .cell-code}\nquantile(results$p_diff_hat, c(0.025, 0.975)) %>% signif(2) # 95% CI\n```\n\n::: {.cell-output-stdout}\n```\n 2.5% 97.5% \n    0     0 \n```\n:::\n:::\n\n## \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(results) +\n  geom_histogram(aes(p_diff_hat))  + \n  geom_vline(xintercept = quantile(results$p_diff_hat, c(0.05 , 0.95 )), col = \"gold1\", size = 2) + # 90% CI \n  geom_vline(xintercept = quantile(results$p_diff_hat, c(0.025, 0.975)), col = \"maroon\", size = 2) # 95% CI\n```\n\n::: {.cell-output-display}\n![](lec-9_files/figure-revealjs/unnamed-chunk-27-1.png){fig-align='center' width=80%}\n:::\n:::\n\n## \n\n::: callout-note\n## Two sides of the same coin\n\nIn the two examples, the HT and the CI agree with one another. This is not a coincidence; they will agree in the vast majority of cases!\n\nWe can show mathematically that a HT and a CI are really two sides of the same coin.\n:::\n\n## What does 90% and 95% mean?\n\nRemember that if we could obtain multiple samples, they'd all be a bit different.\n\n$\\Rightarrow$ the corresponding CIs would also be a bit different\n\n. . .\n\n-   A 90% CI will capture the true value of the parameter 90% of the time.\n\n-   A 95% CI will be wider and thus more likely to capture the truth (95% of the time).\n\n. . .\n\n-   Trade off between being informative and true.\n\n## \n\n![](images/lec-9/ci.png)\n\nSource: [IMS](https://www.openintro.org/book/ims/)\n\n## \n\n::: {.callout-tip icon=\"false\"}\n## Group exercises - CI\n\nExercises [17.3](https://openintro-ims.netlify.app/inference-two-props.html#chp17-exercises) (only do part c) and [17.5](https://openintro-ims.netlify.app/inference-two-props.html#chp17-exercises)\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div class=\"countdown\" id=\"timer_62a39e39\" style=\"right:0;bottom:0;\" data-warnwhen=\"0\">\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n:::\n:::\n\n# Recap\n\n## Recap\n\n-   One proportion\n\n    -   HT via simulation\n\n    -   CI via bootstrap\n\n-   Two proportions\n\n    -   HT via simulation\n\n    -   CI via bootstrap",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"..\\site_libs/countdown-0.3.5/countdown.css\" rel=\"stylesheet\" />\r\n<script src=\"..\\site_libs/countdown-0.3.5/countdown.js\"></script>\r\n<script src=\"..\\site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"..\\site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ],
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}